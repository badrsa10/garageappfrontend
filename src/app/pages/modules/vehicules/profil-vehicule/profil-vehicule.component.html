<div class="p-6 bg-gray-50">
    <!-- üîπ Control Panel -->
    <div class="flex justify-between items-center p-4 rounded-lg mb-6">
        <button pButton class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 shadow-md transition" (click)="goBack()"> < Pr√©c√©dent</button>

        <div class="flex gap-4">
            <button pButton class="bg-yellow-500 text-white px-4 py-2 rounded-lg hover:bg-yellow-600 shadow-md transition" (click)="openEditDialog()">Modifier Info</button>

            <button pButton class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 shadow-md transition" (click)="deleteVehicule()">Supprimer V√©hicule</button>
        </div>
    </div>

    <!-- üîπ Vehicle Information -->
    <div *ngIf="vehicule && client" class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Vehicle Info Card -->
        <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
            <h2 class="text-2xl font-semibold mb-4 text-gray-800">Vehicle Profile</h2>
            <p class="text-gray-700"><strong>Marque:</strong> {{ vehicule.marque }}</p>
            <p class="text-gray-700"><strong>Mod√®le:</strong> {{ vehicule.modele }}</p>
            <p class="text-gray-700"><strong>Ann√©e:</strong> {{ vehicule.annee }}</p>
            <p class="text-gray-700"><strong>Matricule:</strong> {{ vehicule.matricule }}</p>
            <p class="text-gray-700" *ngIf="vehicule.numeroSerie"><strong>Num√©ro de s√©rie:</strong> {{ vehicule.numeroSerie }}</p>
        </div>

        <!-- Client/Owner Info Card -->
        <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
            <h2 class="text-2xl font-semibold mb-4 text-gray-800">Owner Profile</h2>
            <p class="text-gray-700"><strong>Nom:</strong> {{ client.nom }}</p>
            <p class="text-gray-700"><strong>Pr√©nom:</strong> {{ client.prenom }}</p>
            <p class="text-gray-700"><strong>T√©l√©phone:</strong> {{ client.tel }}</p>
            <p class="text-gray-700"><strong>Email:</strong> {{ client.email }}</p>
        </div>
    </div>

    <!-- (Optional) Related Data table ‚Äî e.g., maintenance history -->
    <div class="mt-6" *ngIf="historiques.length > 0">
        <h3 class="text-xl font-semibold mb-4">Maintenance History</h3>
        <div class="overflow-x-auto">
            <p-table #dt [value]="historiques" [paginator]="true" [rows]="10" sortField="date_historique" 
                [sortOrder]="-1" [globalFilterFields]="['date_historique', 'libelle_pieceouservice', 'remarque']">
                <ng-template pTemplate="caption" #caption>
                    <div class="flex justify-between items-center flex-column sm:flex-row">
                        <button pButton label="Clear" class="p-button-outlined mb-2" icon="pi pi-filter-slash" (click)="clear(dt)">Clear</button>
                        <p-iconfield iconPosition="left" class="ml-auto px-auto">
                            <p-inputicon>
                                <i class="pi pi-search"></i>
                            </p-inputicon>
                            <input pInputText type="text" (input)="onGlobalFilter(dt, $event)" placeholder="Search Historique" />
                        </p-iconfield>
                    </div>
                </ng-template>

                <ng-template pTemplate="header">
                    <tr>
                        <th pSortableColumn="date_historique">
                            Date
                            <p-sortIcon field="date_historique"></p-sortIcon>
                        </th>
                        <th pSortableColumn="libelle_pieceouservice">
                            Pi√®ce / Service
                            <p-sortIcon field="libelle_pieceouservice"></p-sortIcon>
                        </th>
                        <th>Remarque</th>
                    </tr>
                </ng-template>

                <ng-template pTemplate="body" let-h>
                    <tr>
                        <td>{{ h.date_historique | date: 'shortDate' }}</td>
                        <td>{{ h.libelle_pieceouservice }}</td>
                        <td>{{ h.remarque }}</td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </div>

    <!-- Dialog: Edit Vehicle -->
    <p-dialog header="Edit Vehicle Info" [(visible)]="editDialog" [modal]="true" [breakpoints]="{ '960px': '75vw' }" [style]="{ width: '30vw' }">
        <div class="p-6 space-y-4">
            <div class="space-y-1">
                <label class="block font-medium">Marque</label>
                <input type="text" pInputText [(ngModel)]="editedVehicule.marque" class="w-full p-2 border rounded-lg" />
            </div>
            <div class="space-y-1">
                <label class="block text-gray-700 font-medium">Mod√®le</label>
                <input type="text" pInputText [(ngModel)]="editedVehicule.modele" class="w-full p-2 border rounded-lg" />
            </div>
            <div class="space-y-1">
                <label class="block text-gray-700 font-medium">Ann√©e</label>
                <input type="number" pInputText [(ngModel)]="editedVehicule.annee" class="w-full p-2 border rounded-lg" />
            </div>
            <div class="space-y-1">
                <label class="block text-gray-700 font-medium">Matricule</label>
                <input type="text" pInputText [(ngModel)]="editedVehicule.matricule" class="w-full p-2 border rounded-lg" />
            </div>
        </div>

        <ng-template #footer>
            <div class="flex justify-end space-x-4 p-4 bg-gray-100 rounded-b-lg">
                <button pButton label="Cancel" class="bg-gray-500 text-white px-4 py-2 rounded-lg" (click)="editDialog = false">Fermer</button>
                <button pButton label="Save Changes" class="bg-blue-500 text-white px-4 py-2 rounded-lg" (click)="saveVehiculeChanges()">Modifier</button>
            </div>
        </ng-template>
    </p-dialog>
</div>
